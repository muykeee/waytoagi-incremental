<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>通往AGI之路</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #1a1a1a;
            color: #ffffff;
            font-family: Arial, sans-serif;
        }
        #game-container {
            text-align: center;
            width: 90%;
            max-width: 800px;
            padding: 20px;
            background-color: #2a2a2a;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }
        #spiral {
            width: 400px;
            height: 400px;
            margin: 20px auto;
        }
        button {
            font-size: 14px;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            background-color: #4a4a4a;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s;
            user-select: none;
        }
        button:hover {
            background-color: #5a5a5a;
        }
        #research {
            font-size: 18px;
            padding: 15px 30px;
        }
        #upgrades {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .upgrade {
            margin: 10px;
            padding: 15px;
            border: 1px solid #3a3a3a;
            border-radius: 5px;
            width: 180px;
            background-color: #333333;
            transition: background-color 0.3s;
        }
        .upgrade:hover {
            background-color: #3a3a3a;
        }
        h1 {
            color: #4a90e2;
        }
        h3 {
            color: #4a90e2;
            margin-top: 0;
        }
        #endGameModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        #endGameContent {
            background-color: #2a2a2a;
            padding: 40px;
            border-radius: 10px;
            text-align: center;
        }
        #endGameContent p {
            font-size: 24px;
            color: #ffffff;
        }
        #endGameContent button {
            font-size: 18px;
            padding: 10px 20px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>通往AGI之路</h1>
        <canvas id="spiral" width="400" height="400"></canvas>
        <p>研究点数: <span id="researchPoints">0</span></p>
        <p>每秒研究点数: <span id="pointsPerSecond">1.00</span></p>
        <button id="research">研究</button>
        <div id="upgrades">
            <div class="upgrade">
                <h3>神经网络架构</h3>
                <p>等级: <span id="aLevel">0</span></p>
                <p>效果: +<span id="aEffect">1</span> 点/次</p>
                <p>成本: <span id="aCost">10</span> 点</p>
                <p>成本增长: 10%</p> <!-- 添加成本增长提示 -->
                <button onclick="buyUpgrade('a')">升级</button>
            </div>
            <div class="upgrade">
                <h3>算法优化</h3>
                <p>等级: <span id="bLevel">0</span></p>
                <p>效果: x<span id="bEffect">1.00</span> 倍率</p>
                <p>成本: <span id="bCost">50</span> 点</p>
                <p>成本增长: 10%</p> <!-- 添加成本增长提示 -->
                <button onclick="buyUpgrade('b')">升级</button>
            </div>
            <div class="upgrade">
                <h3>数据处理能力</h3>
                <p>等级: <span id="cLevel">0</span></p>
                <p>效果: +<span id="cEffect">1</span> 点/秒</p>
                <p>成本: <span id="cCost">100</span> 点</p>
                <p>成本增长: 10%</p> <!-- 添加成本增长提示 -->
                <button onclick="buyUpgrade('c')">升级</button>
            </div>
            <div class="upgrade">
                <h3>并行计算</h3>
                <p>等级: <span id="dLevel">0</span></p>
                <p>效果: x<span id="dEffect">1.00</span> 倍率</p>
                <p>成本: <span id="dCost">200</span> 点</p>
                <p>成本增长: 10%</p> <!-- 添加成本增长提示 -->
                <button onclick="buyUpgrade('d')">升级</button>
            </div>
            <div class="upgrade">
                <h3>认知突破</h3>
                <p>等级: <span id="eLevel">0</span></p>
                <p>效果: x<span id="eEffect">1.00</span> 总倍率</p>
                <p>成本: <span id="eCost">1000</span> 点</p>
                <p>成本增长: 10%</p> <!-- 添加成本增长提示 -->
                <button onclick="buyUpgrade('e')">升级</button>
            </div>
            <div class="upgrade">
                <h3>量子加速</h3>
                <p>等级: <span id="fLevel">0</span></p>
                <p>效果: <span id="fEffect">1.00</span> 次/秒</p>
                <p>成本: <span id="fCost">5000</span> 点</p>
                <p>成本增长: 10%</p> <!-- 添加成本增长提示 -->
                <button onclick="buyUpgrade('f')">升级</button>
            </div>
        </div>
    </div>

    <!-- 游戏结束模态框 -->
    <div id="endGameModal">
        <div id="endGameContent">
            <p id="endGameMessage">已经达到全面AGI！</p>
            <button id="continueGame">继续游戏</button>
            <button id="endGame">结束游戏</button>
        </div>
    </div>

    <script>
        let researchPoints = 0;
        let animationFrame = null;
        const goalPoints = 100000000; // 1亿点研究目标
        let startTime = Date.now(); // 游戏开始时间

        const canvas = document.getElementById('spiral');
        const ctx = canvas.getContext('2d');
        const researchPointsDisplay = document.getElementById('researchPoints');
        const pointsPerSecondDisplay = document.getElementById('pointsPerSecond');
        const researchButton = document.getElementById('research');

        const upgrades = {
            a: { level: 0, effect: 1, cost: 10, increment: 1 },
            b: { level: 0, effect: 1, cost: 50, increment: 0.1 },
            c: { level: 0, effect: 1, cost: 100, increment: 1 }, // 初始效果为 +1 点/秒
            d: { level: 0, effect: 1, cost: 200, increment: 0.1 },
            e: { level: 0, effect: 1, cost: 1000, increment: 0.1 },
            f: { level: 0, effect: 1, cost: 5000, increment: 0.1 }
        };

function drawSpiral() {
    // 清空画布
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // 控制螺旋增长的因子（基于 researchPoints）
    const angleFactor = researchPoints * 0.1; // 研究点数越多，螺旋增长越快

    // 螺旋中心
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;

    // 控制螺旋的半径增长速度（线性增长）
    const a = 5;  // 控制初始半径
    const b = 0.5;  // 控制螺旋的扩展速率

    // 设置最大半径，防止螺旋跑出画布
    const maxRadiusLimit = Math.min(centerX, centerY) - 10;

    // 绘制螺旋
    ctx.lineWidth = 2;
    ctx.lineCap = 'round';
    ctx.beginPath();

    // 根据 researchPoints 控制螺旋角度范围
    const maxAngle = angleFactor; // 最大角度由 researchPoints 决定

    for (let angle = 0; angle <= maxAngle; angle += 0.1) {
        // 线性增长的半径公式，确保螺旋线不会扩展得太快
        let r = a + b * angle;

        // 限制最大半径
        r = Math.min(r, maxRadiusLimit);

        // 计算螺旋的 x, y 坐标
        const x = centerX + r * Math.cos(angle);
        const y = centerY + r * Math.sin(angle);

        // 设置颜色，随角度变化
        const hue = (angle * 10) % 360;
        const lightness = 50 + Math.sin(angle * 0.1) * 20;
        ctx.strokeStyle = `hsl(${hue}, 100%, ${lightness}%)`;

        // 如果是第一个点，moveTo 到该点，否则 lineTo 连接到该点
        if (angle === 0) {
            ctx.moveTo(x, y); // 移动到第一个点
        } else {
            ctx.lineTo(x, y); // 连接到后续的点
        }
    }

    // 完成螺旋绘制
    ctx.stroke();

    // 请求下一帧绘制
    animationFrame = requestAnimationFrame(drawSpiral);
}

        function research() {
            researchPoints += getPointsPerClick();
            checkGameEnd();
            updateDisplay();
        }

        function getPointsPerClick() {
            return upgrades.a.effect * upgrades.b.effect * upgrades.e.effect;
        }

        function getPointsPerSecond() {
            return upgrades.c.effect * upgrades.d.effect * upgrades.e.effect * upgrades.f.effect;
        }

        function updateDisplay() {
            researchPointsDisplay.textContent = Math.floor(researchPoints);
            pointsPerSecondDisplay.textContent = getPointsPerSecond().toFixed(2);
            for (const [key, upgrade] of Object.entries(upgrades)) {
                document.getElementById(`${key}Level`).textContent = upgrade.level;
                document.getElementById(`${key}Effect`).textContent = upgrade.effect.toFixed(2);
                document.getElementById(`${key}Cost`).textContent = Math.floor(upgrade.cost);
            }
        }

        function buyUpgrade(type) {
            const upgrade = upgrades[type];
            if (researchPoints >= upgrade.cost) {
                researchPoints -= upgrade.cost;
                upgrade.level++;
                upgrade.effect += upgrade.increment;
                upgrade.cost *= 1.1; // 成本倍率调整为1.10（每次升级后增加10%）
                updateDisplay();
            }
        }

        function autoResearch() {
            researchPoints += getPointsPerSecond() / 10; // 每0.1秒增加十分之一的每秒点数
            checkGameEnd();
            updateDisplay();
        }

        // 检查是否达到目标点数
        function checkGameEnd() {
            if (researchPoints >= goalPoints) {
                endGame();
            }
        }

        // 结束游戏，显示模态框
        function endGame() {
            document.getElementById('endGameModal').style.display = 'flex';
            clearInterval(autoResearchInterval); // 停止自动研究
            cancelAnimationFrame(animationFrame); // 停止动画

            const timeSpent = formatTimeSpent(Date.now() - startTime); // 计算花费时间
            document.getElementById('endGameMessage').textContent = `已经达到全面AGI！你花费了 ${timeSpent} 完成游戏。`;
        }

        // 格式化时间为 'xx小时xx分xx秒'
        function formatTimeSpent(milliseconds) {
            const seconds = Math.floor(milliseconds / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const remainingMinutes = minutes % 60;
            const remainingSeconds = seconds % 60;
            return `${hours}小时${remainingMinutes}分${remainingSeconds}秒`;
        }

        // 继续游戏
        document.getElementById('continueGame').addEventListener('click', function() {
            document.getElementById('endGameModal').style.display = 'none';
            autoResearchInterval = setInterval(autoResearch, 100); // 恢复自动研究
            animationFrame = requestAnimationFrame(drawSpiral); // 恢复动画
        });

        // 结束游戏
        document.getElementById('endGame').addEventListener('click', function() {
            alert('游戏结束！感谢你的游玩！');
            window.location.reload(); // 重新加载页面，重置游戏
        });

        researchButton.addEventListener('mousedown', function() {
            research();
            this.interval = setInterval(research, 100);
        });

        researchButton.addEventListener('mouseup', function() {
            clearInterval(this.interval);
        });

        researchButton.addEventListener('mouseleave', function() {
            clearInterval(this.interval);
        });

        // 触摸设备支持
        researchButton.addEventListener('touchstart', function(e) {
            e.preventDefault();
            research();
            this.interval = setInterval(research, 100);
        });

        researchButton.addEventListener('touchend', function() {
            clearInterval(this.interval);
        });

        let autoResearchInterval = setInterval(autoResearch, 100); // 每0.1秒执行一次自动研究
        updateDisplay();
        animationFrame = requestAnimationFrame(drawSpiral);
    </script>
</body>
</html>
